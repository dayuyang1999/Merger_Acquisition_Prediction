Traceback (most recent call last):
  File "main.py", line 88, in <module>
    main()
  File "main.py", line 84, in main
    model_trained = train(dataset, config,  device)
  File "main.py", line 48, in train
    loss, timing_loss, choice_loss  = model(arr_b.float(), arr_c.float(), arr_delta_time.float(), event_data, non_event_data, estimate_length, choice_data_dict)
  File "/home/dalab5/miniconda3/envs/GNN/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/dalab5/Projects/MA_packed/model.py", line 180, in forward
    event_lambda = self.timing_net(mat_b, mat_c, event_data) # (L3, )
  File "/home/dalab5/miniconda3/envs/GNN/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/dalab5/Projects/MA_packed/model.py", line 233, in forward
    c = torch.index_select(mat_c, 1, arr_c_idx[0]) # (L3, embedding_c)
TypeError: index_select() received an invalid combination of arguments - got (tuple, int, Tensor), but expected one of:
 * (Tensor input, name dim, Tensor index, *, Tensor out)
 * (Tensor input, int dim, Tensor index, *, Tensor out)
CUDA availability: True
tensor([ 0,  2,  2, 12])
(tensor([[[-2.6139e-01,  2.6219e-02, -2.5539e-04,  2.8462e-03, -4.8714e-02,
          -5.9636e-02,  3.9976e-02,  6.9533e-02, -5.7625e-02,  3.2389e-01,
           2.2659e-01,  1.4679e-01, -4.6106e-03, -9.2407e-02, -1.2243e-01,
          -2.3889e-01],
         [-3.5862e-01,  1.5716e-01, -7.9346e-02, -1.8046e-01, -1.6883e-01,
          -3.1036e-02, -6.1751e-03,  8.5501e-02, -6.3251e-02,  3.6569e-01,
           2.3463e-01,  1.7201e-01,  7.6668e-02, -9.6131e-02, -1.2476e-01,
          -2.9094e-01],
         [-6.9263e-01,  6.2482e-01, -2.4659e-02, -3.0089e-01, -3.0075e-01,
          -2.3633e-01,  2.9964e-01,  2.4034e-01,  5.7987e-02,  7.1443e-01,
           4.2918e-01,  5.0206e-01,  2.5635e-01, -3.4134e-01, -6.5012e-01,
          -5.8244e-01],
         [-8.7590e-01,  8.0670e-01,  6.6657e-02, -1.1357e-01, -4.2599e-01,
          -4.1913e-01,  5.0665e-01,  3.4591e-01,  1.3311e-01,  8.6553e-01,
           5.9706e-01,  7.0697e-01,  4.0160e-01, -4.6250e-01, -8.7513e-01,
          -6.9816e-01],
         [-9.9485e-01,  9.9991e-01,  6.6657e-02, -2.8130e-01, -4.2599e-01,
          -4.2078e-01,  6.0916e-01,  3.4604e-01,  1.3311e-01,  9.9998e-01,
           5.9706e-01,  8.5039e-01,  4.0160e-01, -9.4491e-01, -1.0000e+00,
          -1.0000e+00],
         [-1.0000e+00,  1.0000e+00,  6.6657e-02,  3.1278e-01, -4.2599e-01,
          -4.2078e-01,  6.1197e-01,  3.4604e-01,  1.3311e-01,  1.0000e+00,
           5.9706e-01,  9.1422e-01,  4.0160e-01, -1.0000e+00, -1.0000e+00,
          -1.0000e+00],
         [-1.0000e+00,  1.0000e+00,  6.6660e-02, -4.7210e-01, -4.2599e-01,
          -4.2740e-01,  7.1980e-01,  3.4670e-01,  1.3311e-01,  1.0000e+00,
           5.9716e-01,  9.6233e-01,  4.0160e-01, -1.0000e+00, -1.0000e+00,
          -9.9997e-01],
         [-9.9347e-01,  9.7893e-01,  1.3636e-01, -2.1046e-01, -5.2566e-01,
          -5.8707e-01,  8.0919e-01,  4.0995e-01,  1.5900e-01,  9.9379e-01,
           7.0429e-01,  9.7815e-01,  4.7945e-01, -8.4384e-01, -9.8690e-01,
          -8.2249e-01],
         [-9.9902e-01,  9.9859e-01,  1.3891e-01, -4.6286e-01, -5.2647e-01,
          -6.3563e-01,  8.7697e-01,  4.2234e-01,  1.5905e-01,  9.9961e-01,
           7.1095e-01,  9.8990e-01,  4.8079e-01, -9.4811e-01, -9.9996e-01,
          -9.9108e-01],
         [-6.9307e-01,  6.4444e-01,  2.3742e-02, -3.9592e-01, -3.9069e-01,
          -2.2137e-01,  4.4277e-01,  3.8276e-01,  1.1045e-01,  8.0650e-01,
           4.0316e-01,  4.6183e-01,  5.0045e-01, -4.2813e-01, -5.7729e-01,
          -5.7326e-01],
         [-9.8855e-01,  9.9991e-01,  2.3742e-02,  5.7907e-02, -3.9069e-01,
          -2.2341e-01,  5.3916e-01,  3.8287e-01,  1.1045e-01,  9.9998e-01,
           4.0316e-01,  6.9021e-01,  5.0045e-01, -9.4809e-01, -1.0000e+00,
          -1.0000e+00],
         [-9.7329e-01,  9.6045e-01,  8.2735e-02, -3.1671e-01, -5.2188e-01,
          -3.7115e-01,  6.7791e-01,  4.3812e-01,  1.6295e-01,  9.7349e-01,
           5.7591e-01,  8.4402e-01,  5.7136e-01, -7.1975e-01, -9.6134e-01,
          -7.5875e-01],
         [-9.9989e-01,  1.0000e+00,  8.2735e-02, -1.1751e-01, -5.2188e-01,
          -3.7116e-01,  7.0873e-01,  4.3812e-01,  1.6295e-01,  1.0000e+00,
           5.7591e-01,  9.1919e-01,  5.7136e-01, -9.9555e-01, -1.0000e+00,
          -1.0000e+00],
         [-1.0000e+00,  1.0000e+00,  8.2735e-02, -2.8903e-01, -5.2188e-01,
          -3.7126e-01,  7.5113e-01,  4.3813e-01,  1.6295e-01,  1.0000e+00,
           5.7591e-01,  9.6162e-01,  5.7136e-01, -9.9984e-01, -1.0000e+00,
          -1.0000e+00],
         [-1.0000e+00,  1.0000e+00,  8.2735e-02,  1.7657e-01, -5.2188e-01,
          -3.7126e-01,  7.5449e-01,  4.3813e-01,  1.6295e-01,  1.0000e+00,
           5.7591e-01,  9.7904e-01,  5.7136e-01, -1.0000e+00, -1.0000e+00,
          -1.0000e+00],
         [-1.0000e+00,  1.0000e+00,  8.2755e-02, -4.7694e-01, -5.2188e-01,
          -3.8433e-01,  8.2763e-01,  4.3936e-01,  1.6295e-01,  1.0000e+00,
           5.7627e-01,  9.9085e-01,  5.7137e-01, -9.9999e-01, -1.0000e+00,
          -9.9983e-01],
         [-1.0000e+00,  1.0000e+00,  8.2756e-02, -3.4618e-01, -5.2188e-01,
          -3.8894e-01,  8.7152e-01,  4.3970e-01,  1.6295e-01,  1.0000e+00,
           5.7632e-01,  9.9569e-01,  5.7137e-01, -1.0000e+00, -1.0000e+00,
          -9.9998e-01],
         [-1.0000e+00,  1.0000e+00,  8.2756e-02, -1.1009e-01, -5.2188e-01,
          -3.8894e-01,  8.8041e-01,  4.3970e-01,  1.6295e-01,  1.0000e+00,
           5.7632e-01,  9.9782e-01,  5.7137e-01, -1.0000e+00, -1.0000e+00,
          -1.0000e+00],
         [-1.0000e+00,  1.0000e+00,  8.2756e-02, -2.0475e-02, -5.2188e-01,
          -3.8894e-01,  8.8431e-01,  4.3970e-01,  1.6295e-01,  1.0000e+00,
           5.7632e-01,  9.9888e-01,  5.7137e-01, -1.0000e+00, -1.0000e+00,
          -1.0000e+00],
         [-1.0000e+00,  1.0000e+00,  8.2767e-02, -4.4810e-01, -5.2188e-01,
          -3.9921e-01,  9.1795e-01,  4.4060e-01,  1.6295e-01,  1.0000e+00,
           5.7654e-01,  9.9950e-01,  5.7137e-01, -1.0000e+00, -1.0000e+00,
          -9.9989e-01],
         [-9.9833e-01,  9.9649e-01,  1.2234e-01, -4.4208e-01, -5.6783e-01,
          -5.4135e-01,  9.4476e-01,  4.8295e-01,  1.7210e-01,  9.9673e-01,
           6.5695e-01,  9.9900e-01,  6.0120e-01, -9.1264e-01, -9.9650e-01,
          -8.6056e-01],
         [-9.0312e-01,  8.6790e-01,  1.0693e-01, -3.9904e-01, -6.0549e-01,
          -4.0396e-01,  7.5079e-01,  4.9204e-01,  2.5574e-01,  9.1936e-01,
           6.3109e-01,  8.6858e-01,  6.6033e-01, -5.7515e-01, -8.3872e-01,
          -5.7505e-01],
         [-9.9994e-01,  1.0000e+00,  1.0693e-01,  4.8578e-02, -6.0549e-01,
          -4.0396e-01,  7.6065e-01,  4.9204e-01,  2.5574e-01,  1.0000e+00,
           6.3109e-01,  9.2680e-01,  6.6033e-01, -9.9869e-01, -1.0000e+00,
          -1.0000e+00],
         [-9.3225e-01,  9.0354e-01,  1.0821e-01, -2.8543e-01, -6.5680e-01,
          -3.9441e-01,  7.0332e-01,  5.1059e-01,  3.1816e-01,  9.3998e-01,
           6.4776e-01,  8.8477e-01,  6.9801e-01, -6.3101e-01, -8.9787e-01,
          -6.5235e-01],
         [-9.9571e-01,  9.9965e-01,  1.0821e-01, -3.2647e-01, -6.5680e-01,
          -4.0138e-01,  7.7601e-01,  5.1115e-01,  3.1816e-01,  9.9990e-01,
           6.4783e-01,  9.4344e-01,  6.9801e-01, -9.3904e-01, -1.0000e+00,
          -9.9995e-01],
         [-9.9934e-01,  9.9997e-01,  1.1178e-01, -4.4527e-01, -6.5772e-01,
          -4.6880e-01,  8.5511e-01,  5.2286e-01,  3.1822e-01,  9.9998e-01,
           6.5802e-01,  9.7429e-01,  6.9916e-01, -9.7746e-01, -1.0000e+00,
          -9.8614e-01],
         [-9.9999e-01,  1.0000e+00,  1.1178e-01, -2.4195e-01, -6.5772e-01,
          -4.6886e-01,  8.7383e-01,  5.2286e-01,  3.1822e-01,  1.0000e+00,
           6.5802e-01,  9.8737e-01,  6.9916e-01, -9.9927e-01, -1.0000e+00,
          -1.0000e+00],
         [-1.0000e+00,  1.0000e+00,  1.1179e-01, -4.2841e-01, -6.5772e-01,
          -4.7901e-01,  9.0922e-01,  5.2380e-01,  3.1822e-01,  1.0000e+00,
           6.5824e-01,  9.9425e-01,  6.9917e-01, -9.9986e-01, -1.0000e+00,
          -9.9982e-01],
         [-1.0000e+00,  1.0000e+00,  1.1322e-01, -4.4499e-01, -6.5800e-01,
          -5.2340e-01,  9.4009e-01,  5.3093e-01,  3.1824e-01,  1.0000e+00,
           6.6314e-01,  9.9737e-01,  6.9962e-01, -9.9877e-01, -1.0000e+00,
          -9.9319e-01],
         [-1.0000e+00,  1.0000e+00,  1.1322e-01,  2.0700e-01, -6.5800e-01,
          -5.2340e-01,  9.4071e-01,  5.3093e-01,  3.1824e-01,  1.0000e+00,
           6.6314e-01,  9.9853e-01,  6.9962e-01, -1.0000e+00, -1.0000e+00,
          -1.0000e+00],
         [-1.0000e+00,  1.0000e+00,  1.1322e-01,  8.8452e-01, -6.5800e-01,
          -5.2340e-01,  9.4071e-01,  5.3093e-01,  3.1824e-01,  1.0000e+00,
           6.6314e-01,  9.9897e-01,  6.9962e-01, -1.0000e+00, -1.0000e+00,
          -1.0000e+00],
         [-9.9802e-01,  9.9297e-01,  1.7744e-01, -3.4105e-01, -6.9480e-01,
          -6.7831e-01,  9.5945e-01,  5.6351e-01,  3.2793e-01,  9.9743e-01,
           7.4708e-01,  9.9867e-01,  7.2006e-01, -8.5658e-01, -9.9707e-01,
          -8.5481e-01],
         [-9.9999e-01,  1.0000e+00,  1.7744e-01, -2.5529e-01, -6.9480e-01,
          -6.7833e-01,  9.6415e-01,  5.6351e-01,  3.2793e-01,  1.0000e+00,
           7.4708e-01,  9.9934e-01,  7.2006e-01, -9.9570e-01, -1.0000e+00,
          -1.0000e+00],
         [-1.0000e+00,  1.0000e+00,  1.7745e-01, -4.6195e-01, -6.9480e-01,
          -6.8414e-01,  9.7389e-01,  5.6422e-01,  3.2793e-01,  1.0000e+00,
           7.4721e-01,  9.9970e-01,  7.2007e-01, -9.9917e-01, -1.0000e+00,
          -9.9986e-01],
         [-1.0000e+00,  1.0000e+00,  1.7745e-01,  1.5156e-01, -6.9480e-01,
          -6.8414e-01,  9.7420e-01,  5.6422e-01,  3.2793e-01,  1.0000e+00,
           7.4721e-01,  9.9983e-01,  7.2007e-01, -1.0000e+00, -1.0000e+00,
          -1.0000e+00],
         [-9.9976e-01,  9.9941e-01,  2.0103e-01, -5.4929e-01, -7.0714e-01,
          -7.5310e-01,  9.8341e-01,  5.8701e-01,  3.3001e-01,  9.9932e-01,
           7.7790e-01,  9.9985e-01,  7.2811e-01, -9.5319e-01, -9.9950e-01,
          -9.1727e-01],
         [-9.9999e-01,  1.0000e+00,  2.0103e-01, -3.5137e-01, -7.0714e-01,
          -7.5362e-01,  9.8663e-01,  5.8705e-01,  3.3001e-01,  1.0000e+00,
           7.7790e-01,  9.9993e-01,  7.2811e-01, -9.9541e-01, -1.0000e+00,
          -1.0000e+00],
         [-1.0000e+00,  1.0000e+00,  2.0103e-01,  2.6572e-01, -7.0714e-01,
          -7.5362e-01,  9.8670e-01,  5.8705e-01,  3.3001e-01,  1.0000e+00,
           7.7790e-01,  9.9996e-01,  7.2811e-01, -1.0000e+00, -1.0000e+00,
          -1.0000e+00],
         [-1.0000e+00,  1.0000e+00,  2.0103e-01, -2.4292e-01, -7.0714e-01,
          -7.5362e-01,  9.8726e-01,  5.8705e-01,  3.3001e-01,  1.0000e+00,
           7.7790e-01,  9.9998e-01,  7.2811e-01, -1.0000e+00, -1.0000e+00,
          -1.0000e+00],
         [-1.0000e+00,  1.0000e+00,  2.0103e-01, -1.2445e-01, -7.0714e-01,
          -7.5362e-01,  9.8775e-01,  5.8705e-01,  3.3001e-01,  1.0000e+00,
           7.7790e-01,  9.9999e-01,  7.2811e-01, -1.0000e+00, -1.0000e+00,
          -1.0000e+00],
         [-1.0000e+00,  1.0000e+00,  2.0103e-01,  4.5968e-02, -7.0714e-01,
          -7.5362e-01,  9.8790e-01,  5.8705e-01,  3.3001e-01,  1.0000e+00,
           7.7790e-01,  9.9999e-01,  7.2811e-01, -1.0000e+00, -1.0000e+00,
          -1.0000e+00],
         [-1.0000e+00,  1.0000e+00,  2.0104e-01, -5.2140e-01, -7.0714e-01,
          -7.5796e-01,  9.9119e-01,  5.8766e-01,  3.3001e-01,  1.0000e+00,
           7.7800e-01,  1.0000e+00,  7.2811e-01, -9.9999e-01, -1.0000e+00,
          -9.9987e-01],
         [-1.0000e+00,  1.0000e+00,  2.0104e-01,  5.6035e-01, -7.0714e-01,
          -7.5796e-01,  9.9120e-01,  5.8766e-01,  3.3001e-01,  1.0000e+00,
           7.7800e-01,  1.0000e+00,  7.2811e-01, -1.0000e+00, -1.0000e+00,
          -1.0000e+00]]], grad_fn=<TransposeBackward1>), tensor([[[-1.0000,  1.0000,  0.2010,  0.5604, -0.7071, -0.7580,  0.9912,
           0.5877,  0.3300,  1.0000,  0.7780,  1.0000,  0.7281, -1.0000,
          -1.0000, -1.0000]]], grad_fn=<StackBackward>))