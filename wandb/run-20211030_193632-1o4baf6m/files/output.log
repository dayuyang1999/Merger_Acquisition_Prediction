
CUDA availability: True
#### arr_b tensor([[[ 1.6107,  0.2177, -0.0807, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 1.8378,  0.2896, -0.0807, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 2.2109,  0.3706, -0.0807, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 2.5649,  0.4498, -0.0807, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 2.7934,  0.5735, -0.2877, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 3.2103,  0.5564, -0.2813, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 3.7867,  0.5924, -0.2826, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 4.3058,  0.6133, -0.2556, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 3.2397,  0.4858, -0.0807, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 3.2397,  0.4858, -0.0807, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 3.2397,  0.4858, -0.0807, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 5.3681,  0.8729, -0.2334, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 3.2397,  0.4858, -0.0807, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 5.2710,  0.7727,  0.1726, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 5.0511,  0.7244,  0.2207, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 3.2397,  0.4858, -0.0807, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 3.2397,  0.4858, -0.0807, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 3.2397,  0.4858, -0.0807, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 4.3120,  0.7036,  0.3016, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 3.2397,  0.3324, -0.0807, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 3.2397,  0.3956, -0.0807, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 3.2397,  0.3668, -0.0807, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466],
         [ 3.2397,  0.3505, -0.0807, -0.3466, -0.3466, -0.3466, -0.3466,
          -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466, -0.3466]]]) torch.Size([1, 23, 14])
#### mat_b tensor([[ 6.2096e-02,  6.1890e-02,  1.9985e-02, -6.8725e-02,  1.1831e-01,
         -1.0637e-01, -5.0478e-02, -1.0688e-01, -1.4612e-01,  1.1481e-01,
          7.4944e-02,  8.3352e-02, -7.9253e-02,  3.1547e-01, -9.4596e-02,
          9.2825e-02, -1.8162e-01, -3.0110e-02, -2.5249e-01, -1.7371e-01,
          7.6686e-02,  3.2547e-02, -5.6274e-02,  8.2595e-02, -1.0985e-01,
         -8.9735e-02,  4.6996e-02, -1.4892e-01,  9.4657e-02,  9.3214e-02,
          2.0535e-01,  1.8302e-02],
        [ 9.5494e-02,  6.8197e-02,  2.7261e-02, -7.6459e-04,  4.7262e-02,
         -1.9842e-02,  3.3180e-02,  1.0852e-01, -1.6427e-01,  2.0418e-02,
         -7.7541e-03, -1.9882e-02, -2.9074e-01,  2.2529e-01, -1.8551e-01,
         -1.4380e-02, -7.9573e-02, -5.9744e-02, -1.4566e-01, -2.6245e-01,
         -4.5134e-03,  1.5253e-01, -1.2824e-01,  2.9808e-01,  9.4185e-02,
          5.3006e-02,  1.5594e-01, -1.9471e-02, -3.9516e-03,  1.4392e-01,
          1.5868e-01, -5.2547e-02],
        [ 1.1975e-01, -5.4204e-02,  2.0488e-01, -5.2722e-03, -1.5342e-02,
         -1.6319e-01,  8.5971e-02,  9.5988e-04,  2.2938e-02,  3.5370e-01,
         -1.6226e-01,  8.1643e-02, -2.0909e-01,  2.8602e-02,  1.4259e-01,
         -2.4427e-02, -3.1786e-01, -7.7402e-02, -4.3787e-02, -3.5587e-01,
          8.1114e-02,  2.1414e-01,  9.4959e-02, -7.9298e-03, -6.1835e-02,
         -3.9465e-02,  1.5507e-01, -6.5970e-02,  3.0802e-02,  3.0204e-01,
          1.7233e-01,  1.5033e-01],
        [-1.0710e-02, -8.2176e-03,  2.9645e-01, -2.6865e-01,  1.4097e-01,
          6.2918e-02,  8.2071e-02, -1.9121e-01, -1.0309e-01,  1.7295e-01,
         -4.0526e-01,  2.6009e-02, -1.5944e-01,  2.5567e-01, -4.0268e-02,
          8.5591e-02, -3.2432e-01,  2.5015e-01, -1.8295e-01, -6.5380e-02,
         -1.6382e-01,  2.8892e-01, -8.4260e-02,  3.8396e-02,  1.6574e-01,
         -3.7603e-01,  2.7729e-01,  7.3883e-02,  1.3150e-01,  3.3422e-01,
          2.4672e-01,  1.8989e-02],
        [ 2.0779e-01,  6.5120e-02,  2.1503e-01, -1.7526e-01,  8.0018e-02,
         -1.0552e-01,  3.6472e-01, -3.6398e-02, -3.8091e-01,  2.3964e-01,
         -2.0194e-01, -8.1882e-03, -3.0177e-01,  3.3968e-01, -6.0057e-02,
          8.8325e-02, -2.5792e-01,  2.8247e-02, -1.0559e-01, -2.3808e-01,
          8.1838e-02,  2.0602e-01, -1.4006e-01,  7.9324e-02, -1.7437e-02,
         -2.5653e-01,  3.0831e-01,  4.1809e-02,  3.8031e-01,  2.5544e-01,
         -1.0332e-01,  1.2996e-01],
        [ 3.0868e-01,  2.4755e-01,  2.9881e-01, -5.6089e-02,  4.1864e-02,
          8.3919e-02,  3.3941e-01, -1.1142e-02, -1.9148e-01,  3.8651e-01,
         -1.9094e-01, -8.7058e-02, -5.7397e-01,  1.8842e-01, -7.6380e-02,
         -2.2723e-02, -1.6327e-01, -1.0617e-01, -8.8741e-02, -4.3831e-01,
          2.7397e-01,  1.4078e-01, -1.1179e-02,  3.2175e-01, -5.9999e-02,
         -2.8152e-01,  4.0167e-01, -7.0732e-04,  2.1683e-01,  2.8744e-01,
         -7.8886e-02,  4.6527e-02],
        [ 2.1262e-01,  1.6967e-01,  4.0227e-01, -3.1195e-01,  8.7813e-03,
          1.7482e-01, -4.4748e-02,  7.7774e-03, -4.6202e-01,  4.4094e-01,
         -2.1728e-01, -1.6149e-01, -1.6413e-01,  3.0247e-01, -2.4111e-01,
          7.8507e-02, -4.3861e-01,  2.7461e-02, -9.9077e-02, -4.0171e-01,
         -2.1165e-01,  2.6818e-01,  2.1195e-02,  1.9789e-01, -1.1134e-01,
         -4.6787e-01,  2.9502e-01, -1.5465e-01,  2.5376e-01,  2.5270e-01,
          1.1625e-01,  2.8071e-02],
        [ 3.2088e-01,  3.5038e-01,  5.3128e-01, -2.6678e-01, -2.9437e-02,
          1.1941e-01,  1.4767e-01, -2.3881e-01, -2.1422e-01, -9.6858e-02,
         -8.4538e-01,  6.0767e-02, -4.2131e-01,  3.3002e-01, -3.5691e-02,
         -4.8860e-02, -4.8188e-01, -7.8447e-02,  9.0093e-02, -1.6477e-01,
         -2.7856e-02,  2.4774e-01,  2.2588e-01,  3.6102e-01, -2.1621e-02,
         -3.9734e-01,  6.9058e-01,  2.3060e-01,  2.9178e-01,  6.4020e-01,
          1.1089e-01,  2.5773e-01],
        [ 1.8860e-01, -3.7979e-02,  5.5723e-01, -1.5354e-02, -4.3162e-01,
          1.0278e-01, -4.4188e-02, -9.8878e-02, -2.8042e-01,  2.0972e-01,
         -3.1047e-01,  2.5335e-02, -3.7277e-01,  3.8639e-01, -5.1991e-02,
          3.2488e-02, -2.7598e-01,  3.6653e-03, -1.8673e-02, -4.4928e-02,
         -4.3866e-02,  5.6624e-02,  9.7101e-02, -7.7542e-02, -1.3937e-02,
         -1.5889e-01,  2.4771e-01,  2.5644e-01,  1.4970e-01,  3.3479e-01,
          7.4199e-02,  3.0697e-01],
        [ 1.0125e-01,  8.3225e-02,  3.0645e-01, -2.4231e-02, -1.0068e-01,
          2.3805e-02,  7.4746e-02, -2.7803e-01, -3.9322e-01,  3.7193e-01,
         -1.0291e-01, -5.9076e-02, -2.7158e-01,  4.4201e-01, -8.3074e-02,
          1.3989e-01, -3.6708e-01,  5.7144e-03, -6.6392e-02, -1.3272e-01,
          1.4865e-01,  1.4146e-01,  5.5430e-02,  2.0718e-01, -7.6410e-02,
         -1.0388e-01,  4.4607e-01,  8.4944e-03,  2.5289e-01,  3.2395e-01,
          1.5674e-01,  7.9881e-02],
        [ 2.8716e-01,  1.6250e-01,  4.3644e-01, -2.5287e-01, -7.4341e-02,
          2.0173e-01,  9.7044e-02, -9.5040e-02, -3.7918e-01,  1.9109e-01,
         -2.6148e-01, -1.0626e-01, -4.6183e-01,  3.3012e-01, -2.8109e-03,
          1.2219e-02, -2.4721e-01,  9.9852e-02, -4.3933e-03, -2.9217e-01,
         -2.7240e-02,  2.6201e-01, -7.5270e-02,  3.7483e-01,  1.2561e-01,
         -2.4396e-01,  3.9161e-01,  1.8544e-01,  3.4986e-01,  4.2955e-01,
          2.3563e-02,  1.4247e-01],
        [ 6.1127e-01,  1.8142e-01,  4.3963e-01, -4.2643e-01,  1.1506e-01,
         -1.8142e-01,  4.0249e-01, -2.1452e-01, -7.7629e-01,  1.5555e-01,
         -2.2598e-01,  1.3268e-01, -2.5597e-01,  9.2023e-01, -9.2305e-02,
          4.3757e-01, -2.8667e-01,  2.4548e-02, -2.7523e-01, -2.8653e-01,
         -4.6716e-02,  2.2715e-01, -1.8525e-01,  1.5894e-01,  5.2250e-02,
         -7.0115e-01,  4.5533e-01,  3.5127e-02,  6.4155e-01,  2.1319e-01,
         -1.9836e-01,  1.7329e-01],
        [ 6.3769e-02,  2.6891e-02,  1.5077e-01, -1.7210e-01,  8.6060e-02,
          1.7182e-02,  7.5158e-02, -2.9811e-02, -3.2402e-01,  1.9393e-01,
         -2.4755e-01, -6.5497e-02, -1.8094e-01,  8.9037e-02, -2.1149e-01,
          2.2977e-01, -3.8860e-01,  6.9037e-02, -3.0639e-01, -1.8144e-01,
         -2.6584e-01,  3.4824e-01, -2.6589e-02,  4.9345e-02,  4.1223e-02,
         -2.0029e-01,  1.9073e-01, -7.6748e-02,  1.8625e-01,  2.8309e-01,
          3.8669e-01,  8.4477e-02],
        [ 3.4068e-01, -5.3405e-02,  5.3470e-01, -3.3962e-01, -2.9872e-01,
          1.5824e-01,  5.4288e-01, -2.2831e-01, -7.9500e-01,  5.3963e-02,
         -1.5975e-01, -2.1517e-01, -6.1269e-01,  2.4177e-01, -9.2515e-02,
         -2.2306e-01, -4.8002e-01,  3.1859e-01,  3.1124e-01, -1.0704e-01,
          1.5086e-01,  2.5918e-01, -1.2095e-01,  4.8266e-01,  4.7572e-02,
         -3.8926e-01,  7.8678e-01,  2.4384e-01,  4.0212e-01,  6.7438e-01,
         -7.5699e-02, -3.9541e-02],
        [ 6.7284e-01,  1.3592e-01,  5.2100e-01, -2.7860e-01, -3.6674e-02,
         -2.6900e-01,  3.6896e-01, -1.4337e-01, -5.1326e-01,  3.6919e-01,
          3.1659e-02,  1.1295e-01, -4.5117e-01,  2.4747e-01,  2.4103e-01,
         -1.0583e-03, -4.4036e-01,  4.3529e-02,  1.8301e-01, -4.4946e-01,
          2.9567e-01, -1.1372e-01,  1.8176e-01,  8.5322e-03, -5.8131e-02,
         -6.4055e-01,  3.3039e-01, -3.0487e-02,  3.9068e-01,  4.6311e-01,
         -3.2170e-01,  5.2724e-02],
        [ 2.1143e-02,  1.7122e-02,  9.6218e-02, -1.8025e-01,  2.0284e-01,
         -5.0208e-02,  1.1906e-01, -1.2237e-01, -1.4998e-01,  3.3530e-01,
         -3.4320e-01, -1.1863e-01, -1.8300e-01,  5.8843e-03, -1.5883e-01,
          1.0160e-01, -4.3505e-01, -1.1966e-01, -2.0587e-01, -1.7819e-02,
         -8.9542e-02,  9.1733e-02,  3.1116e-02,  5.6543e-02,  2.8911e-02,
         -3.2702e-01,  3.4373e-01, -3.8290e-02,  6.5593e-03,  3.5567e-01,
          1.7658e-02,  1.7225e-01],
        [ 2.9913e-01, -4.1221e-02,  2.3713e-01, -6.3267e-02, -2.2413e-01,
         -1.1025e-01,  6.2110e-02, -1.2829e-01, -5.1402e-01,  1.5220e-01,
          1.7468e-04,  1.4519e-02, -3.2690e-01,  2.8076e-01, -1.0642e-01,
         -1.0843e-01, -8.3541e-02,  3.7326e-03, -3.0412e-02, -2.5655e-01,
          8.7376e-03, -1.3715e-01,  9.1827e-02, -1.1546e-03, -6.3183e-02,
         -2.7907e-01,  2.2085e-01,  2.4143e-01,  2.7683e-01,  2.2133e-01,
          1.4811e-02,  1.9423e-01],
        [-8.1324e-02, -1.1644e-02,  2.8916e-01, -3.5582e-01,  3.4324e-03,
         -8.9804e-02,  8.3441e-02, -9.0214e-02,  1.2825e-01,  1.7037e-01,
         -2.5955e-01, -3.1962e-02, -1.8623e-01, -2.0608e-01,  3.4293e-01,
         -1.0245e-01, -4.0286e-01, -1.0109e-02,  3.2357e-02,  1.5564e-02,
         -1.4186e-01,  7.6909e-02, -3.2536e-02, -4.9755e-02,  1.1305e-01,
         -4.1408e-01,  3.6858e-01,  2.6141e-02,  3.1315e-02,  3.8946e-01,
          1.1932e-01,  4.9814e-02],
        [ 2.9922e-02,  1.4318e-02,  4.8782e-01, -3.7220e-01, -2.5362e-01,
          1.4494e-01,  3.0320e-01, -7.0208e-02, -7.0200e-01,  1.8181e-01,
         -3.6118e-02, -3.8571e-01, -2.9590e-01,  2.2678e-01, -3.4860e-01,
         -2.7948e-01, -5.0911e-01,  3.5902e-01,  3.6730e-01, -1.5154e-01,
         -4.3718e-02,  1.6027e-01, -1.2742e-01,  3.6561e-01,  3.7136e-02,
         -4.6049e-01,  6.7053e-01,  4.6857e-02,  9.2698e-02,  4.9633e-01,
         -8.2643e-02, -2.8883e-01],
        [ 2.6044e-01,  4.3175e-03,  3.4916e-01, -2.5698e-01, -2.1736e-01,
         -8.4486e-03,  2.0182e-01, -7.6711e-02, -5.2231e-01,  4.3550e-03,
         -1.7650e-01, -7.9480e-02, -3.2446e-01,  4.4824e-01, -8.4439e-02,
          2.4634e-02, -3.6946e-01,  9.7669e-02,  1.8509e-02, -1.5968e-01,
          7.4135e-03,  1.8113e-01, -2.0493e-01,  1.4925e-01, -2.1332e-02,
         -2.5546e-01,  3.7879e-01,  8.9761e-02,  3.1673e-01,  4.2039e-01,
         -7.4876e-02,  1.7051e-01],
        [ 3.0967e-01, -9.4263e-02,  1.9733e-01, -1.8731e-02, -9.5192e-02,
         -1.2451e-01,  1.1834e-01,  5.0480e-02, -2.1656e-01,  2.5837e-01,
          5.5679e-02,  1.2366e-02, -4.1461e-01, -9.4094e-02, -5.7975e-03,
         -7.1880e-03, -1.8467e-01, -2.1881e-01, -7.3336e-02, -3.7920e-01,
         -2.0071e-03,  1.0532e-01,  1.0867e-01,  1.8997e-01, -2.8881e-02,
         -1.8559e-01,  1.8007e-01,  5.6960e-03,  1.6199e-02,  2.5805e-01,
          2.3054e-01,  7.9553e-02],
        [ 1.9364e-01, -1.4069e-01,  2.8892e-01, -1.3653e-01,  6.3252e-02,
          7.3850e-02,  4.0322e-02, -7.6411e-02, -2.7706e-01,  5.7530e-01,
         -1.7196e-01, -1.2141e-01, -2.9246e-01,  1.7342e-01, -3.0084e-01,
         -4.7725e-02, -3.8287e-01, -4.1748e-03, -4.1584e-02, -2.0929e-01,
          8.1857e-02,  1.7875e-01,  2.4069e-02,  1.5009e-01,  2.4466e-02,
         -3.2705e-01,  2.6713e-01, -8.9235e-02,  1.6404e-03,  3.6610e-01,
          3.7555e-02,  2.9900e-02],
        [-1.2579e-02,  9.3670e-02,  2.9464e-01, -1.6668e-01, -1.2134e-01,
          8.6585e-03, -4.0023e-02, -3.8113e-01, -2.3871e-01,  2.4345e-01,
         -1.9731e-01,  1.9097e-02, -2.3036e-01,  2.7569e-01,  2.4197e-02,
         -6.9458e-02, -4.2002e-01, -6.7988e-02,  4.6903e-02,  2.2479e-02,
          9.0709e-02,  1.5445e-01,  2.0513e-01,  2.2288e-01, -4.9745e-02,
         -1.1049e-01,  5.5109e-01,  1.2059e-01,  1.5129e-01,  4.3191e-01,
          9.8253e-02,  1.9950e-01]], grad_fn=<AddmmBackward>) torch.Size([23, 32])
Traceback (most recent call last):
  File "main.py", line 89, in <module>
    main()
  File "main.py", line 85, in main
    model_trained = train(dataset, config,  device)
  File "main.py", line 48, in train
    loss, timing_loss, choice_loss  = model(arr_b.float(), arr_c.float(), arr_delta_time.float(), event_data, non_event_data, estimate_length, choice_data_dict)
  File "/home/dalab5/miniconda3/envs/GNN/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/dalab5/Projects/MA_packed/model.py", line 181, in forward
    event_lambdas = self.timing_net(mat_b, mat_c, event_data) # (L3, )
  File "/home/dalab5/miniconda3/envs/GNN/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/dalab5/Projects/MA_packed/model.py", line 256, in forward
    rate = self.base_rate + torch.einsum('ble, e->bl', b, self.w_b)  + torch.einsum('ble, e->bl', c, self.w_c) +  torch.transpose(t_emb, dim0=0, dim1=1)#self.omega * torch.exp(-self.omega * delta_t)
  File "/home/dalab5/miniconda3/envs/GNN/lib/python3.8/site-packages/torch/functional.py", line 408, in einsum
    return _VF.einsum(equation, operands)  # type: ignore
RuntimeError: einsum() the number of subscripts in the equation (3) does not match the number of dimensions (2) for operand 0 and no ellipsis was given