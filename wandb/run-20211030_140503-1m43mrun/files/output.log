/home/dalab5/miniconda3/envs/GNN/lib/python3.8/site-packages/torch/nn/functional.py:1709: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
Traceback (most recent call last):
  File "main.py", line 88, in <module>
    main()
  File "main.py", line 84, in main
    model_trained = train(dataset, config,  device)
  File "main.py", line 54, in train
    choice_loss_e += choice_loss.detach().numpy()[0]
IndexError: too many indices for array: array is 0-dimensional, but 1 were indexed
CUDA availability: True
tensor([[  -234945.5775,  -2505217.6465,   -300483.1852, -81484966.3055]],
       dtype=torch.float64, grad_fn=<AddBackward0>)
tensor([[-inf, -inf, -inf, -inf]], dtype=torch.float64, grad_fn=<MulBackward0>)
tensor([[-7.7496e+134, -2.0119e+250, -7.1873e+110,  -1.8956e+14,  -3.4696e+32,
          -1.6226e+42,  -8.1241e+16,  -4.3682e+73, -6.6560e+131, -2.5790e+199,
          -2.5782e+67, -1.8380e+199,  -1.3926e+05, -1.8193e+263,  -1.5189e+31,
          -2.5290e+33,  -3.2982e+78,  -3.8085e+57,         -inf, -7.6873e+300,
          -9.0171e+36,  -3.2802e+30, -1.1918e+115, -6.9652e+184,  -5.3666e+31,
          -5.7092e+98, -9.5592e+266, -2.6126e+145, -3.3311e+172,         -inf,
          -2.5863e+29,  -3.1731e+12,  -2.1716e+09,  -4.5821e+55, -6.1255e+174,
          -3.7592e+23,  -5.7074e+84,         -inf, -9.1452e+114,  -9.2230e+05,
          -5.4267e+96,  -2.6710e+80, -4.2106e+108, -4.9827e+117,  -1.1714e+45,
          -1.9673e+35,  -3.2035e+86,         -inf,  -1.8615e+37, -4.2552e+178,
         -7.8399e+223, -2.1330e+263,  -3.3716e+32,  -6.2609e+72, -3.5397e+105,
          -2.0754e+78,  -2.4708e+58,  -4.2483e+22, -1.1057e+222,  -1.4798e+43,
         -1.9401e+167,         -inf,  -3.5078e+05,  -2.0467e+26,  -3.8267e+05,
         -4.4959e+106,  -4.5593e+65, -5.1279e+196,  -1.4112e+75,  -2.4685e+17,
          -4.3592e+49, -3.0665e+203, -6.6696e+219, -1.3613e+114, -1.1569e+101,
                 -inf,  -7.0297e+94,  -4.4115e+22, -9.7666e+178, -5.7031e+228,
         -3.1008e+114,  -4.7132e+24,  -4.7215e+66,  -1.9228e+05, -4.7455e+122,
          -3.8056e+80,  -9.0502e+81, -4.9278e+170,  -1.6687e+42, -1.8620e+199,
         -1.8869e+128,  -8.3966e+86,  -1.1476e+05, -2.5250e+129,  -1.7198e+53,
         -2.0768e+119, -1.1738e+145,  -1.7719e+76, -5.9089e+121,  -4.2456e+10,
          -8.6311e+05, -8.2072e+182,         -inf,  -2.3449e+27, -3.3654e+116,
          -3.6653e+21,  -2.5165e+13,  -3.4582e+05,  -5.8116e+10,  -3.4482e+55,
          -1.4315e+85,  -1.0169e+10,  -8.5085e+43,  -3.5765e+05, -1.9539e+183,
          -5.4187e+71, -4.0569e+243, -2.5321e+126,         -inf, -5.9022e+190,
         -3.9233e+259,  -2.0313e+49, -3.1069e+174,  -2.6788e+05,         -inf,
         -4.3779e+225,  -9.3194e+52,         -inf,  -8.9387e+65, -4.3386e+110,
         -3.4548e+210,  -1.7673e+10,  -1.8102e+05,  -7.5943e+20,  -4.1414e+05,
          -2.8151e+28,  -4.6112e+75,  -1.6857e+06,  -2.5692e+46,  -6.5270e+17,
         -4.8327e+229, -1.0299e+122, -4.9479e+183,  -1.3059e+10,  -4.7455e+05,
         -2.6928e+192, -7.8633e+255,  -3.2438e+06,  -1.9107e+21,  -2.3036e+05,
          -1.4320e+96, -3.9698e+216,  -8.0141e+31,  -2.0773e+09,  -1.1405e+08,
         -1.6403e+178, -3.3988e+284, -2.9736e+104,  -5.1123e+49, -2.7357e+177,
                 -inf, -6.2443e+169, -2.3068e+157,         -inf, -1.1161e+132,
          -3.5297e+64, -1.0273e+214, -2.5641e+132,  -2.1317e+18, -7.0730e+294,
                 -inf, -1.0323e+116,  -1.6832e+16,  -1.2709e+47, -9.6325e+211,
         -1.1993e+171,         -inf, -6.2272e+213,  -4.8614e+05, -2.4756e+113,
          -8.1170e+25, -1.3582e+188,  -8.7220e+67,  -7.4964e+41, -1.8626e+216,
          -8.1423e+20,         -inf,  -2.4386e+63,  -1.0128e+39, -1.1791e+139,
          -5.9676e+27, -6.8956e+158, -3.5574e+129,  -1.0799e+27, -1.4397e+151,
         -1.3085e+222, -6.1377e+142, -9.3188e+154,  -1.4668e+74, -6.0904e+229,
          -1.3085e+50,         -inf,  -5.1834e+57,  -2.8521e+16,  -4.4444e+34,
          -5.4879e+71, -5.4470e+169,  -5.3027e+50,  -6.7801e+71, -8.4820e+295,
                 -inf,         -inf, -1.3754e+117, -1.8689e+126,  -6.8758e+32,
          -3.2348e+08,  -1.2829e+44,         -inf, -1.4200e+122,  -1.3098e+49,
          -1.5278e+08,  -2.0103e+05, -9.1828e+304,  -3.9790e+40, -1.5242e+159,
          -3.2411e+86,  -2.3022e+50,         -inf,  -3.8883e+69,  -1.5314e+07,
          -4.1542e+81,  -1.0878e+47,         -inf, -1.4550e+162,  -4.1797e+78,
         -1.8968e+103,  -1.6357e+31, -3.7948e+215,         -inf,  -1.7541e+15,
          -1.4157e+22,  -5.3646e+19, -1.4485e+106,  -1.9019e+26, -4.8667e+247,
          -1.3029e+14,  -8.4485e+17,  -3.7130e+47, -2.7793e+145,         -inf,
          -3.3579e+61,  -1.6705e+47,  -1.2694e+19,         -inf, -4.5830e+151,
          -1.0609e+73,  -2.4183e+69, -5.7984e+168,  -4.0450e+05,  -3.0051e+05,
         -2.1592e+138, -1.0774e+187,  -2.0973e+76,  -2.3835e+40,  -2.4344e+34,
                 -inf,  -7.0479e+62,  -1.4384e+70, -2.1111e+160,  -2.6871e+77,
         -4.2230e+206, -1.2384e+224, -9.1389e+171,  -4.3949e+52, -6.5870e+170,
          -9.6115e+47,  -6.0077e+72,  -1.2676e+15,  -7.5282e+24, -3.2470e+285,
                 -inf, -2.4345e+150,  -5.3203e+28,  -1.8606e+90, -1.7936e+154,
         -4.5460e+151, -5.0450e+118,  -2.4048e+30,         -inf,  -4.8475e+79,
          -5.0524e+76, -7.1237e+284,  -8.2781e+20, -1.3037e+147,  -9.7735e+78,
         -7.5470e+103,         -inf,  -9.6932e+45,  -1.1092e+49,  -2.0899e+22,
         -2.2331e+112, -2.5065e+133, -2.1292e+200,  -6.8607e+64,  -1.3092e+51,
         -2.9188e+181,  -1.1791e+11,  -4.6183e+22,  -1.6427e+87, -5.7423e+112,
          -1.3374e+10, -4.4337e+270, -2.7133e+203,         -inf,  -2.5462e+07,
         -2.7124e+237, -6.1682e+125,         -inf, -1.2269e+208,  -1.8205e+61,
          -4.2984e+36,  -4.8928e+45,  -2.0023e+68,         -inf,  -1.0128e+41,
          -1.7952e+79,  -3.5437e+78,  -9.5031e+90, -1.3704e+197,  -1.7094e+55,
          -1.2596e+59, -2.7819e+299, -1.0819e+124, -5.1905e+146,  -5.7386e+45,
          -5.0130e+34,  -1.8953e+05,  -1.2063e+34,  -7.9525e+58, -2.4884e+119,
         -3.7816e+199,  -5.8270e+73,         -inf,  -2.1705e+05, -1.0271e+135,
          -1.0258e+57, -1.2769e+171,  -6.6692e+60, -4.4766e+122,         -inf,
          -7.4781e+25,         -inf,         -inf, -5.8518e+250,  -3.7057e+66,
          -1.1925e+35,         -inf,         -inf,  -1.5472e+40, -5.1520e+139,
          -7.7329e+98,         -inf,  -1.7648e+41, -3.4658e+178,  -3.8031e+98,
          -1.2934e+51, -7.3196e+169, -2.1136e+221,  -2.4605e+88, -8.5785e+206,
          -8.7381e+08, -2.7606e+181,         -inf,  -2.8752e+47,  -1.1128e+17,
         -2.6666e+177,  -1.0587e+40,  -9.4249e+69,  -6.1572e+18,  -2.5603e+13,
          -2.9699e+51, -3.3885e+101, -9.1381e+125,  -1.8949e+05,  -8.1642e+63,
                 -inf,  -5.8653e+29,  -8.5177e+77,         -inf, -3.2833e+108,
          -7.4266e+64,  -7.1663e+41, -7.6391e+131,  -1.7306e+94,  -1.7588e+20,
          -4.2326e+11,         -inf,  -9.8557e+04,  -4.4860e+64,  -1.3391e+13,
         -1.7966e+160, -1.5125e+200, -9.8500e+172, -8.9807e+207,  -7.3800e+83,
          -1.9500e+84, -6.8559e+206,  -2.2492e+05, -2.1602e+155,  -4.7743e+39,
         -3.8477e+146, -5.2332e+119, -9.3121e+125, -3.0000e+116,  -2.6751e+35,
         -3.1963e+167, -1.1695e+188,  -7.3854e+39, -1.2565e+128,  -1.0708e+18,
          -2.0293e+38, -8.3284e+127,  -4.6096e+13,  -2.3808e+12,  -3.8605e+05,
         -3.2045e+224, -2.6178e+169, -9.2030e+167,  -3.0048e+05,  -4.7349e+07,
          -7.6432e+25, -1.1562e+211,  -2.8461e+72, -8.8456e+254,  -4.7090e+46,
         -4.1897e+116,  -3.5075e+05, -5.3981e+174, -3.2054e+199,  -3.8269e+05,
         -7.0358e+223,  -7.8815e+51,  -1.0757e+10, -1.1424e+167,  -1.7836e+31,
                 -inf, -1.8838e+125,  -2.2653e+39,  -3.9551e+05, -2.4381e+104,
          -3.4215e+75, -5.6056e+150,  -3.1435e+13,         -inf,         -inf,
                 -inf,  -3.8980e+85,  -6.1370e+71,  -2.7827e+87,  -2.1793e+05,
         -4.8328e+161,  -2.9740e+06,  -7.2769e+87,  -1.2456e+85, -9.0644e+304,
          -2.3762e+18,  -6.1480e+59,  -8.4229e+21,  -3.8193e+46, -4.7200e+151,
         -5.7926e+113,  -1.0824e+32, -1.0331e+130,         -inf,  -7.3060e+21,
          -4.4373e+53,         -inf,  -5.2230e+34,  -2.4864e+53,  -9.6929e+31,
          -1.2044e+28,  -6.0931e+12,  -1.0939e+32, -2.4776e+119,  -1.9037e+19,
          -6.0185e+66, -1.8235e+284,  -8.1605e+65,  -2.3921e+97, -2.5343e+177,
          -3.0092e+05,  -6.3450e+41, -3.3390e+194,  -1.1284e+56,  -1.0970e+21,
          -2.9478e+10,  -2.4662e+25,  -4.4631e+44, -7.5667e+108,  -2.2751e+28,
          -6.2795e+16,  -7.1735e+47,  -1.4218e+30, -8.5993e+157,  -2.7925e+22,
         -7.1004e+125,         -inf, -7.5038e+114, -1.0609e+185,  -3.8620e+39,
                 -inf,  -2.5513e+53, -8.8752e+217,  -6.3895e+39,  -1.4743e+38,
          -6.1323e+27, -1.1586e+301,  -2.4670e+13,  -2.6821e+05,         -inf,
          -1.2550e+22,  -3.4427e+91,  -7.6672e+20,         -inf,  -4.3693e+11,
         -8.2149e+142, -5.3368e+134,  -3.7716e+06, -9.4014e+144,  -2.0826e+14,
          -1.3861e+44,  -2.1540e+30,  -7.9179e+63,         -inf,  -1.5395e+16,
          -1.3385e+59,  -1.2663e+91, -2.0211e+273,  -6.3374e+47,         -inf,
         -2.0065e+250, -2.7508e+140, -5.8076e+146,  -3.3327e+78, -4.9146e+247,
          -1.7462e+29,         -inf,  -1.1460e+26,  -3.1714e+05,         -inf,
          -2.5071e+10, -6.1163e+119, -2.7432e+126,  -6.4102e+23, -6.3948e+195,
         -4.8759e+174,  -4.1389e+47,  -1.0492e+06, -5.8767e+188, -2.4041e+201,
         -3.7220e+159, -1.3178e+147,  -1.0055e+35,  -3.0968e+05,  -1.6216e+10,
         -2.8346e+182,  -1.4091e+33, -5.9227e+229, -4.9497e+118, -4.4511e+283,
          -2.6057e+61,  -7.2416e+31, -1.7127e+106,  -6.0687e+09, -1.6339e+124,
          -1.3328e+12,         -inf, -9.8536e+180, -2.2963e+249, -1.3989e+106,
         -7.0075e+118,  -5.2522e+10,  -3.6973e+52,  -2.3802e+05,  -1.3650e+20,
          -7.4459e+83,  -6.1027e+92,         -inf, -1.6404e+292,  -2.6948e+56,
         -2.9031e+184,  -1.4381e+74, -5.9780e+127, -1.3605e+156,  -3.0967e+05,
          -8.7536e+12,  -1.1307e+91,  -9.9693e+37,  -7.7513e+67,  -4.2209e+75,
          -1.5857e+81,  -1.8464e+46, -6.8944e+108, -9.4892e+202, -3.2249e+275,
         -2.2919e+170,  -2.0160e+88,  -3.2799e+58, -8.9609e+109, -9.1567e+127,
          -1.2720e+34, -4.1616e+127,  -4.6072e+83, -2.0567e+136, -2.3657e+181,
         -1.5361e+249,  -1.8021e+95, -1.7228e+210, -9.8087e+132,  -1.6037e+71,
         -5.4389e+217,         -inf,  -1.6185e+18, -1.7826e+101,  -1.8236e+32,
         -1.6629e+129, -6.2104e+190, -7.0646e+133,  -6.8153e+07, -5.0287e+152,
         -6.2071e+134, -8.0034e+105,  -3.2428e+20,  -1.2519e+36,  -6.9265e+96,
                 -inf,         -inf, -1.4657e+170,  -8.9041e+08,  -1.4427e+15]],
       dtype=torch.float64, grad_fn=<AddBackward0>)
tensor([[-inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf,
         -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf, -inf]],
       dtype=torch.float64, grad_fn=<MulBackward0>)