
CUDA availability: True
  0%|                                                                                                                                                                                       | 0/496 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "main.py", line 123, in <module>
    main()
  File "main.py", line 119, in main
    model_trained = train(dataset, config,  device)
  File "main.py", line 80, in train
    event_lambdas, non_event_tuple, choice_tuple  = model(arr_b.float(), arr_c.float(), arr_delta_time.float(), event_data, non_event_data, estimate_length, choice_data_dict)
  File "/home/dalab5/miniconda3/envs/GNN/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/dalab5/Projects/MA_packed/model.py", line 197, in forward
    choice_tuple = self.choice_net(mat_b, mat_c, choice_data_dict, self.s_year, self.e_year)
  File "/home/dalab5/miniconda3/envs/GNN/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/dalab5/Projects/MA_packed/model.py", line 366, in forward
    pred_logits = torch.stack(pred_logits_lst)
RuntimeError: stack expects each tensor to be equal size, but got [1, 1, 7502] at entry 0 and [1, 1, 5319] at entry 1
#### mat_b tensor([[[ 1.5082e-01,  4.5957e-01, -1.2372e-01,  2.2736e-02,  1.8322e-01,
           1.0098e-01,  2.4012e-01, -4.4208e-02,  2.5217e-01,  6.3255e-01,
           1.8890e-01,  2.5592e-01,  2.5203e-01, -1.5297e-01, -3.1799e-01,
           1.5725e-01,  2.0848e-01, -1.0840e-01, -8.9249e-02, -2.2109e-01,
           6.4558e-02, -3.3066e-01,  7.7980e-02,  8.8232e-02, -8.3242e-02,
          -6.1287e-02, -9.7553e-02,  1.3741e-01, -2.4105e-01, -2.8032e-01,
          -3.0155e-02,  3.0925e-01],
         [ 1.5014e-01,  4.6720e-01, -1.2424e-01,  2.4010e-02,  1.8192e-01,
           1.0224e-01,  2.3740e-01, -3.6418e-02,  2.5774e-01,  6.3288e-01,
           1.9099e-01,  2.5513e-01,  2.5264e-01, -1.5089e-01, -3.1840e-01,
           1.6352e-01,  2.1064e-01, -1.0585e-01, -9.9239e-02, -2.2904e-01,
           5.8799e-02, -3.2625e-01,  8.9167e-02,  8.5365e-02, -8.7322e-02,
          -5.7839e-02, -1.0324e-01,  1.3612e-01, -2.3993e-01, -2.7560e-01,
          -2.6634e-02,  3.1126e-01],
         [ 1.4996e-01,  4.7875e-01, -1.2449e-01,  2.7104e-02,  1.7947e-01,
           1.0494e-01,  2.3206e-01, -2.3514e-02,  2.6573e-01,  6.3361e-01,
           1.9368e-01,  2.5348e-01,  2.5336e-01, -1.4642e-01, -3.1775e-01,
           1.7307e-01,  2.1287e-01, -1.0172e-01, -1.1618e-01, -2.4267e-01,
           4.9966e-02, -3.1816e-01,  1.0744e-01,  8.0039e-02, -9.2737e-02,
          -5.3170e-02, -1.1207e-01,  1.3351e-01, -2.3801e-01, -2.6811e-01,
          -2.1597e-02,  3.1398e-01],
         [ 1.4973e-01,  4.8944e-01, -1.2481e-01,  2.9995e-02,  1.7722e-01,
           1.0748e-01,  2.2712e-01, -1.1553e-02,  2.7327e-01,  6.3444e-01,
           1.9608e-01,  2.5202e-01,  2.5394e-01, -1.4229e-01, -3.1731e-01,
           1.8211e-01,  2.1512e-01, -9.7825e-02, -1.3197e-01, -2.5546e-01,
           4.1651e-02, -3.1061e-01,  1.2438e-01,  7.5147e-02, -9.7929e-02,
          -4.8703e-02, -1.2028e-01,  1.3108e-01, -2.3611e-01, -2.6109e-01,
          -1.6865e-02,  3.1647e-01],
         [ 1.4481e-01,  4.9799e-01, -1.2752e-01,  3.2923e-02,  1.7537e-01,
           1.0607e-01,  2.2382e-01, -2.0605e-03,  2.8282e-01,  6.2775e-01,
           2.0387e-01,  2.5428e-01,  2.5277e-01, -1.5280e-01, -3.2299e-01,
           1.9413e-01,  2.2236e-01, -8.6852e-02, -1.3882e-01, -2.5869e-01,
           2.6970e-02, -3.1308e-01,  1.4163e-01,  7.5453e-02, -1.0666e-01,
          -3.9395e-02, -1.2334e-01,  1.3014e-01, -2.2493e-01, -2.6053e-01,
          -1.5482e-02,  3.1302e-01],
         [ 1.4748e-01,  5.0785e-01, -1.2606e-01,  3.9169e-02,  1.7170e-01,
           1.1078e-01,  2.1563e-01,  1.2234e-02,  2.8813e-01,  6.2953e-01,
           2.0462e-01,  2.5146e-01,  2.5288e-01, -1.4435e-01, -3.1851e-01,
           2.0245e-01,  2.2098e-01, -8.2968e-02, -1.5892e-01, -2.7551e-01,
           1.9509e-02, -3.0174e-01,  1.6107e-01,  6.7505e-02, -1.0883e-01,
          -3.7170e-02, -1.3182e-01,  1.2578e-01, -2.2297e-01, -2.5282e-01,
          -1.1927e-02,  3.1440e-01],
         [ 1.4950e-01,  5.2185e-01, -1.2526e-01,  4.6371e-02,  1.6725e-01,
           1.1628e-01,  2.0602e-01,  3.0838e-02,  2.9705e-01,  6.3187e-01,
           2.0647e-01,  2.4860e-01,  2.5299e-01, -1.3509e-01, -3.1496e-01,
           2.1506e-01,  2.2151e-01, -7.7314e-02, -1.8473e-01, -2.9713e-01,
           8.2820e-03, -2.8810e-01,  1.8687e-01,  5.8036e-02, -1.1393e-01,
          -3.2351e-02, -1.4347e-01,  1.2067e-01, -2.1968e-01, -2.4234e-01,
          -6.2724e-03,  3.1651e-01],
         [ 1.5186e-01,  5.3345e-01, -1.2438e-01,  5.2635e-02,  1.6346e-01,
           1.2168e-01,  1.9775e-01,  4.6603e-02,  3.0418e-01,  6.3522e-01,
           2.0700e-01,  2.4594e-01,  2.5302e-01, -1.2521e-01, -3.1119e-01,
           2.2529e-01,  2.2127e-01, -7.3446e-02, -2.0752e-01, -3.1684e-01,
          -2.5554e-04, -2.7531e-01,  2.0813e-01,  4.9321e-02, -1.1768e-01,
          -2.8805e-02, -1.5375e-01,  1.1612e-01, -2.1791e-01, -2.3269e-01,
          -1.1691e-03,  3.1874e-01],
         [ 1.5212e-01,  5.0683e-01, -1.2361e-01,  3.8446e-02,  1.7197e-01,
           1.1413e-01,  2.1526e-01,  1.1484e-02,  2.8402e-01,  6.3655e-01,
           1.9857e-01,  2.4828e-01,  2.5425e-01, -1.3127e-01, -3.1249e-01,
           1.9698e-01,  2.1537e-01, -9.0668e-02, -1.6336e-01, -2.8145e-01,
           2.7827e-02, -2.9401e-01,  1.5617e-01,  6.3799e-02, -1.0381e-01,
          -4.3068e-02, -1.3442e-01,  1.2497e-01, -2.3232e-01, -2.4860e-01,
          -1.0110e-02,  3.1934e-01],
         [ 1.5212e-01,  5.0683e-01, -1.2361e-01,  3.8446e-02,  1.7197e-01,
           1.1413e-01,  2.1526e-01,  1.1484e-02,  2.8402e-01,  6.3655e-01,
           1.9857e-01,  2.4828e-01,  2.5425e-01, -1.3127e-01, -3.1249e-01,
           1.9698e-01,  2.1537e-01, -9.0668e-02, -1.6336e-01, -2.8145e-01,
           2.7827e-02, -2.9401e-01,  1.5617e-01,  6.3799e-02, -1.0381e-01,
          -4.3068e-02, -1.3442e-01,  1.2497e-01, -2.3232e-01, -2.4860e-01,
          -1.0110e-02,  3.1934e-01],
         [ 1.5212e-01,  5.0683e-01, -1.2361e-01,  3.8446e-02,  1.7197e-01,
           1.1413e-01,  2.1526e-01,  1.1484e-02,  2.8402e-01,  6.3655e-01,
           1.9857e-01,  2.4828e-01,  2.5425e-01, -1.3127e-01, -3.1249e-01,
           1.9698e-01,  2.1537e-01, -9.0668e-02, -1.6336e-01, -2.8145e-01,
           2.7827e-02, -2.9401e-01,  1.5617e-01,  6.3799e-02, -1.0381e-01,
          -4.3068e-02, -1.3442e-01,  1.2497e-01, -2.3232e-01, -2.4860e-01,
          -1.0110e-02,  3.1934e-01],
         [ 1.5116e-01,  5.5763e-01, -1.2678e-01,  6.1131e-02,  1.5809e-01,
           1.2941e-01,  1.8616e-01,  7.4247e-02,  3.2422e-01,  6.4204e-01,
           2.1032e-01,  2.4399e-01,  2.5318e-01, -1.1250e-01, -3.1222e-01,
           2.5000e-01,  2.2889e-01, -6.4773e-02, -2.4777e-01, -3.5141e-01,
          -2.0304e-02, -2.5535e-01,  2.4737e-01,  3.7380e-02, -1.3268e-01,
          -1.6111e-02, -1.7457e-01,  1.1004e-01, -2.1227e-01, -2.1342e-01,
           1.1569e-02,  3.2409e-01],
         [ 1.5212e-01,  5.0683e-01, -1.2361e-01,  3.8446e-02,  1.7197e-01,
           1.1413e-01,  2.1526e-01,  1.1484e-02,  2.8402e-01,  6.3655e-01,
           1.9857e-01,  2.4828e-01,  2.5425e-01, -1.3127e-01, -3.1249e-01,
           1.9698e-01,  2.1537e-01, -9.0668e-02, -1.6336e-01, -2.8145e-01,
           2.7827e-02, -2.9401e-01,  1.5617e-01,  6.3799e-02, -1.0381e-01,
          -4.3068e-02, -1.3442e-01,  1.2497e-01, -2.3232e-01, -2.4860e-01,
          -1.0110e-02,  3.1934e-01],
         [ 1.5713e-01,  5.5368e-01, -1.2332e-01,  5.5041e-02,  1.6137e-01,
           1.3436e-01,  1.8906e-01,  6.8976e-02,  3.1603e-01,  6.5352e-01,
           1.9868e-01,  2.3923e-01,  2.5509e-01, -9.2240e-02, -3.0287e-01,
           2.3628e-01,  2.1980e-01, -7.8971e-02, -2.4889e-01, -3.5695e-01,
          -3.8706e-03, -2.4519e-01,  2.3173e-01,  3.4747e-02, -1.2328e-01,
          -2.6481e-02, -1.7688e-01,  1.1088e-01, -2.3090e-01, -2.0850e-01,
           1.4583e-02,  3.3448e-01],
         [ 1.5793e-01,  5.4880e-01, -1.2255e-01,  5.2387e-02,  1.6281e-01,
           1.3324e-01,  1.9200e-01,  6.2762e-02,  3.1141e-01,  6.5385e-01,
           1.9675e-01,  2.3897e-01,  2.5559e-01, -9.2194e-02, -3.0195e-01,
           2.3003e-01,  2.1761e-01, -8.2840e-02, -2.4116e-01, -3.5074e-01,
           2.1929e-03, -2.4788e-01,  2.2206e-01,  3.6808e-02, -1.1959e-01,
          -3.0152e-02, -1.7341e-01,  1.1229e-01, -2.3458e-01, -2.1132e-01,
           1.2802e-02,  3.3506e-01],
         [ 1.5212e-01,  5.0683e-01, -1.2361e-01,  3.8446e-02,  1.7197e-01,
           1.1413e-01,  2.1526e-01,  1.1484e-02,  2.8402e-01,  6.3655e-01,
           1.9857e-01,  2.4828e-01,  2.5425e-01, -1.3127e-01, -3.1249e-01,
           1.9698e-01,  2.1537e-01, -9.0668e-02, -1.6336e-01, -2.8145e-01,
           2.7827e-02, -2.9401e-01,  1.5617e-01,  6.3799e-02, -1.0381e-01,
          -4.3068e-02, -1.3442e-01,  1.2497e-01, -2.3232e-01, -2.4860e-01,
          -1.0110e-02,  3.1934e-01],
         [ 1.5212e-01,  5.0683e-01, -1.2361e-01,  3.8446e-02,  1.7197e-01,
           1.1413e-01,  2.1526e-01,  1.1484e-02,  2.8402e-01,  6.3655e-01,
           1.9857e-01,  2.4828e-01,  2.5425e-01, -1.3127e-01, -3.1249e-01,
           1.9698e-01,  2.1537e-01, -9.0668e-02, -1.6336e-01, -2.8145e-01,
           2.7827e-02, -2.9401e-01,  1.5617e-01,  6.3799e-02, -1.0381e-01,
          -4.3068e-02, -1.3442e-01,  1.2497e-01, -2.3232e-01, -2.4860e-01,
          -1.0110e-02,  3.1934e-01],
         [ 1.5212e-01,  5.0683e-01, -1.2361e-01,  3.8446e-02,  1.7197e-01,
           1.1413e-01,  2.1526e-01,  1.1484e-02,  2.8402e-01,  6.3655e-01,
           1.9857e-01,  2.4828e-01,  2.5425e-01, -1.3127e-01, -3.1249e-01,
           1.9698e-01,  2.1537e-01, -9.0668e-02, -1.6336e-01, -2.8145e-01,
           2.7827e-02, -2.9401e-01,  1.5617e-01,  6.3799e-02, -1.0381e-01,
          -4.3068e-02, -1.3442e-01,  1.2497e-01, -2.3232e-01, -2.4860e-01,
          -1.0110e-02,  3.1934e-01],
         [ 1.5656e-01,  5.3344e-01, -1.2290e-01,  4.1838e-02,  1.6843e-01,
           1.2640e-01,  2.0457e-01,  3.9812e-02,  3.0021e-01,  6.5312e-01,
           1.9364e-01,  2.4075e-01,  2.5721e-01, -9.9440e-02, -3.0542e-01,
           2.1336e-01,  2.1629e-01, -9.3527e-02, -2.1118e-01, -3.2543e-01,
           1.8833e-02, -2.6214e-01,  1.8945e-01,  4.7451e-02, -1.1291e-01,
          -3.7985e-02, -1.6142e-01,  1.1872e-01, -2.4331e-01, -2.2178e-01,
           7.7677e-03,  3.3603e-01],
         [ 1.5592e-01,  5.0411e-01, -1.2103e-01,  4.2276e-02,  1.7048e-01,
           1.1643e-01,  2.1170e-01,  1.2932e-02,  2.7960e-01,  6.3674e-01,
           1.9644e-01,  2.4663e-01,  2.5358e-01, -1.2698e-01, -3.0681e-01,
           1.9410e-01,  2.0987e-01, -9.0879e-02, -1.6600e-01, -2.8407e-01,
           3.0033e-02, -2.9074e-01,  1.5706e-01,  6.0643e-02, -9.8556e-02,
          -4.6842e-02, -1.3308e-01,  1.2287e-01, -2.3234e-01, -2.4937e-01,
          -1.2759e-02,  3.1728e-01],
         [ 1.5435e-01,  5.0524e-01, -1.2209e-01,  4.0697e-02,  1.7110e-01,
           1.1548e-01,  2.1317e-01,  1.2336e-02,  2.8142e-01,  6.3666e-01,
           1.9732e-01,  2.4731e-01,  2.5386e-01, -1.2874e-01, -3.0915e-01,
           1.9529e-01,  2.1214e-01, -9.0787e-02, -1.6491e-01, -2.8300e-01,
           2.9122e-02, -2.9208e-01,  1.5670e-01,  6.1942e-02, -1.0073e-01,
          -4.5282e-02, -1.3364e-01,  1.2373e-01, -2.3233e-01, -2.4905e-01,
          -1.1668e-02,  3.1813e-01]]], grad_fn=<AddBackward0>) torch.Size([1, 21, 32])